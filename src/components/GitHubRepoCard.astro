---
interface Props {
  repo: string; // "owner/name"
  title?: string;
  description?: string;
  showReleases?: boolean;
  class?: string;
}

const {
  repo,
  title,
  description,
  showReleases = true,
  class: className,
} = Astro.props;

const repoUrl = `https://github.com/${repo}`;
const releasesUrl = `${repoUrl}/releases`;
const displayTitle = title ?? repo;
const buttonBaseClass =
  "inline-flex h-11 w-full items-center justify-center border px-5 text-center font-mono text-xs tracking-wider uppercase transition-colors";
const primaryButtonClass = `${buttonBaseClass} border-accent bg-accent text-accent-foreground hover:border-accent-strong hover:bg-[#0047cc]`;
const secondaryButtonClass = `${buttonBaseClass} border-structural bg-transparent text-foreground/80 hover:bg-foreground hover:text-background`;
---

<aside
  class:list={[
    "border-structural bg-surface my-10 border p-6 md:p-8",
    className,
  ]}
  aria-label="GitHub repository"
>
  <div
    class="flex flex-col gap-6 md:flex-row md:items-start md:justify-between"
  >
    <div class="min-w-0">
      <div
        class="border-border text-muted-foreground mb-3 inline-flex items-center gap-2 border px-2 py-1 font-mono text-[10px] tracking-widest uppercase"
      >
        <svg
          width="14"
          height="14"
          viewBox="0 0 24 24"
          aria-hidden="true"
          focusable="false"
        >
          <path
            fill="currentColor"
            d="M12 .5C5.73.5.75 5.61.75 12.02c0 5.11 3.16 9.45 7.55 10.98.55.1.75-.25.75-.55v-2.1c-3.07.68-3.72-1.52-3.72-1.52-.5-1.32-1.23-1.67-1.23-1.67-1-.7.08-.7.08-.7 1.1.08 1.68 1.18 1.68 1.18.98 1.73 2.57 1.23 3.2.93.1-.73.38-1.23.68-1.52-2.45-.28-5.02-1.26-5.02-5.64 0-1.25.43-2.28 1.14-3.08-.12-.28-.5-1.42.1-2.95 0 0 .94-.3 3.08 1.18a10.3 10.3 0 0 1 2.8-.4c.95 0 1.9.13 2.8.4 2.14-1.48 3.08-1.18 3.08-1.18.6 1.53.22 2.67.1 2.95.7.8 1.14 1.83 1.14 3.08 0 4.4-2.58 5.35-5.04 5.63.4.36.75 1.07.75 2.15v3.18c0 .3.2.65.76.55 4.38-1.53 7.53-5.87 7.53-10.98C23.25 5.61 18.27.5 12 .5Z"
          ></path>
        </svg>
        Open source
      </div>

      <div
        class="text-foreground text-xl leading-none font-black break-words uppercase"
      >
        {displayTitle}
      </div>

      {
        description && (
          <p class="text-muted-foreground mt-3 max-w-2xl font-mono text-sm leading-relaxed">
            {description}
          </p>
        )
      }
    </div>

    <div class="flex w-full shrink-0 flex-col gap-2 md:w-48 md:items-stretch">
      <a
        href={repoUrl}
        class={primaryButtonClass}
        target="_blank"
        rel="noreferrer"
      >
        View Repo
      </a>
      {
        showReleases && (
          <a
            href={releasesUrl}
            class={secondaryButtonClass}
            target="_blank"
            rel="noreferrer"
          >
            Releases
          </a>
        )
      }
    </div>
  </div>
</aside>
